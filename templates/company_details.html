{% if current_user %}
    {% if current_user.role == 'user' %}
        {% extends 'base.html' %}
    {% elif current_user.role == 'jobseeker' %}
        {% extends 'jobseeker/jobseeker_base.html' %}
    {% elif current_user.role == 'admin' %}
        {% extends 'admin_base.html' %}
    {% endif %}
{% elif current_user.is_authenticated is None %}
    {% extends 'common_base.html' %}
{% endif %}

{% block content %}

<!-- Tailwind CSS Integration -->
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.5/dist/cdn.min.js" defer></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    };
  </script>


<!-- Main Container -->
<div class="container mx-auto mt-8">
    <!-- Company Card -->
    <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6 space-y-6">
        <!-- Company Details -->
        <div class="text-center space-y-4">
            <!-- Company Logo -->
            {% if company.company_logo %}
                <img src="{{ company.company_logo }}" alt="{{ company.name }} Logo" class="w-32 h-32 mx-auto rounded-full border-2 border-gray-300 dark:border-gray-600">
            {% else %}
                <img src="https://via.placeholder.com/150" alt="Default Logo" class="w-32 h-32 mx-auto rounded-full border-2 border-gray-300 dark:border-gray-600">
            {% endif %}

            <!-- Company Name -->
            <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-100">{{ company.name }}</h2>

            <!-- Location -->
            <p class="text-gray-600 dark:text-gray-400 flex items-center justify-center space-x-2">
                <i class="bi bi-geo-alt-fill text-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
</svg>

                </i>
                <span>{{ company.location }}</span>
            </p>

        </div>

                    <!-- Company Description -->
                    <h3 class="mt-2 text-2xl font-semibold text-gray-800 dark:text-gray-100">Description</h3>

            <div x-data="{ expanded: false }" class="text-gray-700 dark:text-gray-300">
                <p x-bind:class="{ 'line-clamp-3': !expanded }" class="line-clamp-3">{{ company.description }}</p>
                <button @click="expanded = !expanded" class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 font-medium">
                    <span x-text="expanded ? 'Show less' : 'Read more...'">Read more...</span>
                </button>
            </div>


        <!-- Job Posts -->
        <div class="space-y-4">
            <h3 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">Job Openings</h3>
            <div class="overflow-x-auto">
                {% if job_posts and job_posts|length > 0 %}
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead>
                            <tr>
                                <th class="px-4 py-2 text-left text-sm font-semibold text-gray-600 dark:text-gray-300">Position</th>
                                <th class="px-4 py-2 text-left text-sm font-semibold text-gray-600 dark:text-gray-300">Posted On</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                            {% for data in job_posts %}
                                {% if data.job_opening_status == 'Active' and data.status == 'published' %}
                                    <tr>
                                        <td class="px-4 py-2">
                                            <a href="{{ url_for('get_post_by_company_subdomain_and_slug', company_subdomain=company.company_subdomain, job_date=data.created_at.split('T')[0], job_slug=data.slug) }}" class="text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800">
                                                {{ data.job_title }}
                                            </a>
                                        </td>
                                        <td class="px-4 py-2 text-gray-500 dark:text-gray-400">{{ data.created_at.split('T')[0] }}</td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p class="text-center text-gray-500 dark:text-gray-400">No Job Openings right now.</p>
                {% endif %}
            </div>
        </div>

        <!-- Social Links -->
        <div class="flex justify-center space-x-4 mt-6">
            {% if company.linkedin_url %}
                <a href="{{ company.linkedin_url }}" class="text-blue-700 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-500">
                    <i class="bi bi-linkedin text-2xl"></i>
                </a>
            {% endif %}
            {% if company.google_map_url %}
                <a href="{{ company.google_map_url }}" class="text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-500">
                    <i class="bi bi-geo-alt-fill text-2xl"></i>
                </a>
            {% endif %}
            {% if company.twitter_url %}
                <a href="{{ company.twitter_url }}" class="text-black hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300">
                    <i class="bi bi-twitter text-2xl"></i>
                </a>
            {% endif %}
            {% if company.instagram_url %}
                <a href="{{ company.instagram_url }}" class="text-pink-500 hover:text-pink-600 dark:text-pink-400 dark:hover:text-pink-500">
                    <i class="bi bi-instagram text-2xl"></i>
                </a>
            {% endif %}
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Format Date
        document.querySelectorAll('[data-date]').forEach(el => {
            const originalDate = el.getAttribute('data-date');
            const dateObj = new Date(originalDate);
            if (!isNaN(dateObj)) {
                el.textContent = dateObj.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
        });
    });
</script>

{% endblock %}
