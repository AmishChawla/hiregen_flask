{% extends 'jobseeker/jobseeker_base.html' %}

{% block content %}
<style>
.profile-hover-wrapper {
  position: relative;
  display: inline-block;
}

.profile-hover-wrapper:hover .hover-btn {
  display: inline-block;
}

.hover-btn {
  display: none;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  right: -25px;
  cursor: pointer;
}

.hover-btn i {
  font-size: 16px;
  color: grey;
}

.profile-user-img img:hover + .hover-btn {
  display: inline-block;
}


.list-group-item {
    border: none;
    padding: 10px 15px;
    transition: background-color 0.3s ease;
}

.list-group-item:hover {
    background-color: #f0f0f0;
}

.list-group-item i {
    font-size: 1.2rem;
}

.list-group-item a {
    font-size: 0.9rem;
}

.list-group-item a:hover {
    color: #007bff;
    text-decoration: underline;
}

</style>
<style>
  /* General styling for card */
  .card {
    border: none;
    box-shadow: 0 0px 0px rgba(0, 0, 0, 0);
    border-radius: 8px;
    margin-bottom: 20px;
    overflow: hidden;
  }

  .card-header {
    background-color: #ffffff;
    padding: 12px 16px;
    border-bottom: 1px solid #ddd;
  }

  .card-title {
    font-size: 1rem;
    font-weight: 600;
    color: #333;
    margin: 0;
  }

  .card-tools a {
    font-size: 0.85rem;
    font-weight: bold;
    color: #007bff;
    text-decoration: none;
  }

  .card-tools a:hover {
    color: #007bfb
    font-weight: bold;
    text-decoration: none;
  }

  .card-body {
    padding: 16px;
    background-color: #fff;
    font-size: 0.9rem;
    color: #555;
  }

  /* Styling for table inside Resume card */
  #userResumeTable .table-hover tbody tr:hover {
    background-color: #f1f1f1;
  }

  #userResumeTable td.clickable a {
    text-decoration: none;
    color: #007bff;
  }

  /* Styling for items inside each section */
  .container-fluid {
    padding: 8px 0;
    border-bottom: 1px solid #ddd;
  }

  .container-fluid:last-child {
    border-bottom: none;
  }

  .container-fluid div {
    line-height: 1.4;
  }

  /* Modal styling */
  .modal .modal-content {
    border-radius: 8px;
  }

  /* Trash icon */
  .float-sm-right a i {
    transition: color 0.3s ease;
  }

  .float-sm-right a i:hover {
    color: #d9534f;
  }
</style>
<style>
    .upload-resume-card {
        border: 2px dashed #ccc;
        padding: 0;
        text-align: center;
        position: relative;
        margin-bottom: 0;

    }

    .upload-resume-card.dragover {
        border-color: #000;
    }

    .file-input {
        position: absolute;
        left: -9999px;
    }

    .btn-select, .btn-upload {
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 10px;
    }

    .btn-select:hover, .btn-upload:hover {
        background-color: #0056b3;
    }

    .file-list {
        margin-top: 20px;
        text-align: left;
    }

    .file-list p {
        margin: 0;
        padding: 5px;
    }

    .error-message {
        color: red;
        font-size: 14px;
    }

    .disclaimer {
        font-size: 14px;
        color: #555;
    }


.loader {
  width: 100%;
  height: 4.8px;
  display: none;
  position: relative;
  background: rgba(255, 255, 255, 0.15);
  overflow: hidden;
}
.loader::after {
  content: '';
  width: 192px;
  height: 4.8px;
  background: #0d6efd;
  position: absolute;
  top: 0;
  left: 0;
  box-sizing: border-box;
  animation: animloader 2s linear infinite;
}

@keyframes animloader {
  0% {
    left: 0;
    transform: translateX(-100%);
  }
  100% {
    left: 100%;
    transform: translateX(0%);
  }
}

</style>



<section class="content">
      <div class="container-fluid">

            <!-- Profile Image -->
              <div class="mt-4 box-profile">
                <div class="text-center">
                  <div class="">
                    {% if profile_info.profile_picture %}
                  <img class="profile-user-img img-fluid img-circle"
                       src="{{ profile_info.profile_picture }}"
                       alt="User profile picture">
                    {% else %}
                  <img class="profile-user-img img-fluid img-circle"
                       src="{{ url_for('static', filename='images/man.png') }}"
                       alt="User profile picture">
                    {% endif %}

                  <a data-toggle="modal" data-target="#changePictureModal" class="ml-2">
                <i class="link-secondary bi bi-pencil" style="font-size:0.6rem;"></i>
              </a>

                </div>
                </div>


                <h3 class="text-center profile-username" style="text_overflow: hidden;">
                  {{ profile_info.name }}
                  <a data-toggle="modal" data-target="#changeNameModal" class="ml-2">
                  <i class="link-secondary bi bi-pencil" style="font-size:0.6rem;"></i>
                </a>
                </h3>

                <p class="text-center text-secondary" style="text_overflow: hidden; font-size:0.9rem; ">
                  <div class="text-center text-secondary" style="text_overflow: hidden; font-size:0.9rem;">
                  {{ profile_info.email }}

                  <a data-toggle="modal" data-target="#changeEmailModal" class="ml-2">
                    <i class="link-secondary bi bi-pencil" style="font-size:0.6rem;"></i>
                  </a>

                  </div>
                <div class="text-center text-secondary" style="text_overflow: hidden; font-size:0.9rem;">
                  {% if profile_info.phone_number  %}
                  {{ profile_info.phone_number }}
                  {% else %}
                  Your Mobile Number
                  {% endif %}
                  <a data-toggle="modal" data-target="#changePhoneModal" class="ml-2">
                    <i class="link-secondary bi bi-pencil" style="font-size:0.6rem;"></i>
                  </a>
                </div>
                </p>

              </div>
              <!-- /.card-body -->
        <div class="row">
          <div class="col-md-3">
<ul class="list-group mb-3">
  <li class="list-group-item">
    <a href="#profileSummary" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-person-circle me-2"></i> Profile Summary
    </a>
  </li>
  <li class="list-group-item">
    <a href="#resume" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-file-earmark-text me-2"></i> Resume
    </a>
  </li>
  <li class="list-group-item">
    <a href="#education" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-book me-2"></i> Education
    </a>
  </li>
  <li class="list-group-item">
    <a href="#experience" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-briefcase me-2"></i> Experience
    </a>
  </li>
  <li class="list-group-item">
    <a href="#internships" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-building me-2"></i> Internships
    </a>
  </li>
  <li class="list-group-item">
    <a href="#projects" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-folder2-open me-2"></i> Projects
    </a>
  </li>
  <li class="list-group-item">
    <a href="#accomplishments" class="text-decoration-none link-dark d-flex align-items-center">
      <i class="bi bi-trophy me-2"></i> Accomplishments
    </a>
  </li>
</ul>
          </div>
          <div class="col-md-9">
            <div class="card upload-resume-card" id="drop-zone">
            <span class="loader" id="loading-bar-container"></span>

            <div class="card-body">
                <form id="upload-form" method="post" action="{{ url_for('media') }}" enctype="multipart/form-data">
                    <p>Drop files here to upload</p>
                    <p>or</p>
                    <label for="file-input" class="btn-select">Select Files</label>
                    <input type="file" id="file-input" class="file-input" multiple>
                    <div id="file-list" class="file-list"></div>
                    <button type="submit" id="btn-upload" class="btn-upload" style="display:none;">Upload Files</button>
                    <p id="error-message" class="error-message"></p>
                </form>
            </div>
        </div>
            <small class="disclaimer">Maximum upload file size is 2MB.</small>
            <div class="card card-outline" id="profileSummary">
  <div class="card-header">
    <h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">About </h3>
    <div class="card-tools">
      <!-- Buttons, labels, and many other things can be placed here! -->
      <!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addAboutModal" class="text-primary">Add + </a>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body">
    {% if profile_info.profile_summary %}
    {{ profile_info.profile_summary.content }}
  <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='profile_summary', id=profile_info.profile_summary.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>

    {% endif %}


  </div>

  <!-- /.card-body -->
</div>
            <div class="card card-outline" id="resume">
  <div class="card-header">
    <h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Resume </h3>
    <div class="card-tools">
      <!-- Buttons, labels, and many other things can be placed here! -->
      <!-- Here is a label for example -->
      <a href = "{{ url_for('media') }}" class="text-primary">Add + </a>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body">
    <table id="userResumeTable" class="table table-hover">
            <tbody>
        {% for row in resumes %}

            <tr>
<!--              <a href="{{ url_for('admin_view_user_profile', user_id=row.id) }}">-->
                 <td class="clickable"> <a href="{{ root_url + row.file_url }}" style="text-overflow: hidden;"> {{ row.filename }} </a></td>

                <td>
    <a data-bs-toggle="modal" data-bs-target="#deleteModal_{{ row.id }}"><i class="bi bi-trash3-fill link-secondary " style="color:#6b1313; font-size: 1rem"></i></a>

    <!-- Modal for delete button -->
    <div class="modal fade" id="deleteModal_{{ row.id }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="deleteModalLabel_{{ row.id }}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="deleteModalLabel_{{ row.id }}">Delete User</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are you sure?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <a type="button" class="btn btn-danger" href="{{ url_for('delete_media', media_id=row.id)}}">Delete Resume</a>
                </div>
            </div>
        </div>
    </div>
</td>

<!--                </a>-->
            </tr>

        {% endfor %} <!-- Your table body content here -->
            </tbody>

        </table>

  </div>
  <!-- /.card-body -->
</div>
            <div class="card card-outline" id="education">
  <div class="card-header">
    <h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Education </h3>
    <div class="card-tools">
      <!-- Buttons, labels, and many other things can be placed here! -->
      <!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addEducationModal" class="text-primary">Add + </a>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body">
        {% for data in profile_info.education %}
    <div class="container-fluid mb-2">
      <div style="font-size: 0.9rem;">
        {{ data.degree }} in {{ data.field_of_study }} from {{ data.institution_name }}
      </div>
      <div style="color: grey; font-size: 0.8rem;">
        {% if data.is_ongoing %}
        {{ data.start_date }} - Present
        {% else %}
        {{ data.start_date }} - {{ data.end_date }}
        {% endif %}
      </div>
      <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='education', id=data.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>
    </div>

        {% endfor %}
  </div>
  <!-- /.card-body -->
</div>
            <div class="card card-outline" id="experience">
  <div class="card-header">
    <h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Experience </h3>
    <div class="card-tools">
      <!-- Buttons, labels, and many other things can be placed here! -->
      <!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addExperienceModal" class="text-primary">Add + </a>
    </div>
    <!-- /.card-tools -->
  </div>
  <!-- /.card-header -->
  <div class="card-body">
        {% for data in profile_info.experiences %}
    <div class="container-fluid mb-2">
      <div style="font-size: 0.9rem; font-weight:bold;">
        {{ data.position.capitalize() }}
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.company_name.capitalize() }}
      </div>
      <div style="color: grey; font-size: 0.8rem;">
        {% if data.is_ongoing %}
        {{ data.start_date }} - Present
        {% else %}
        {{ data.start_date }} - {{ data.end_date }}
        {% endif %}
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.responsibilities }}
      </div>
      <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='experience', id=data.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>
    </div>

        {% endfor %}
  </div>
  <!-- /.card-body -->
</div>
            <div class="card card-outline" id="internships">
<div class="card-header">
<h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Internships </h3>
<div class="card-tools">
<!-- Buttons, labels, and many other things can be placed here! -->
<!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addInternshipModal" class="text-primary">Add + </a>
</div>
<!-- /.card-tools -->
</div>
<!-- /.card-header -->
<div class="card-body">
        {% for data in profile_info.internships %}
    <div class="container-fluid mb-2">
      <div style="font-size: 0.9rem; font-weight:bold;">
        {{ data.position.capitalize() }}
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.company_name.capitalize() }}
      </div>
      <div style="color: grey; font-size: 0.8rem;">
        {% if data.is_ongoing %}
        {{ data.start_date }} - Present
        {% else %}
        {{ data.start_date }} - {{ data.end_date }}
        {% endif %}
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.job_description }}
      </div>
      <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='internship', id=data.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>

    </div>

        {% endfor %}
</div>
<!-- /.card-body -->
</div>
            <div class="card card-outline" id="projects">
<div class="card-header">
<h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Projects </h3>
<div class="card-tools">
<!-- Buttons, labels, and many other things can be placed here! -->
<!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addProjectModal" class="text-primary">Add + </a>
</div>
<!-- /.card-tools -->
</div>
<!-- /.card-header -->
<div class="card-body">
        {% for data in profile_info.projects %}
    <div class="container-fluid mb-2">
      <div style="font-size: 0.9rem; font-weight:bold;">
        {{ data.title }}
      </div>
      <div style="color: grey; font-size: 0.9rem;">
         <a href="{{ data.project_url }}" style="color: grey;">{{ data.project_url }}</a>
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.description }}
      </div>
      <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='project', id=data.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>

    </div>
        {% endfor %}
</div>
<!-- /.card-body -->
</div>
            <div class="card card-outline" id="accomplishments">
<div class="card-header">
<h3 class="card-title" style="font-weight:bold; font-size:0.9rem;">Accomplishments </h3>
<div class="card-tools">
<!-- Buttons, labels, and many other things can be placed here! -->
<!-- Here is a label for example -->
      <a data-toggle="modal" data-target="#addAccomplishmentModal" class="text-primary">Add + </a>
</div>
<!-- /.card-tools -->
</div>
<!-- /.card-header -->
<div class="card-body">
        {% for data in profile_info.accomplishments %}
    <div class="container-fluid mb-2">
      <div style="font-size: 0.9rem; font-weight:bold;">
        {{ data.title }}
      </div>
      <div style="color: grey; font-size: 0.9rem;">
         <a href="{{ data.project_url }}" style="color: grey;">{{ data.achievement_date }}</a>
      </div>
      <div style="font-size: 0.9rem;">
        {{ data.description }}
      </div>
      <div class="float-sm-right ml-2"><a href="{{url_for('delete_jobseeker_profile_info', type='accomplishment', id=data.id)}}"><i class="bi bi-trash3-fill" style="color:#b5b1b1; font-size: 1rem"></i></a></div><br>

    </div>

        {% endfor %}
</div>
<!-- /.card-body -->
</div>
          </div>
<!-- /.card -->
</div>
        </div>
    </section>

<div class="modal fade" id="addAboutModal" tabindex="-1" role="dialog" aria-labelledby="addAboutModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addAboutModalLabel">Add About</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST">
          {{ about_form.hidden_tag() }}
          <div class="form-group">
            {{ about_form.about.label }}<br>
            {{ about_form.about(class="form-control", placeholder="Describe yourself in a few words") }}
          </div>
          <div class="d-grid gap-2 col-6 mx-auto">
          {{ about_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Education Modal -->
<div class="modal fade" id="addEducationModal" tabindex="-1" role="dialog" aria-labelledby="addEducationModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addEducationModalLabel">Add Education</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST">
          {{ education_form.hidden_tag() }}
          <div class="form-group">
            {{ education_form.institution_name.label }}<br>
            {{ education_form.institution_name(class="form-control") }}
          </div>
          <div class="form-group">
            {{ education_form.degree.label }}<br>
            {{ education_form.degree(class="form-control") }}
          </div>
            <div class="form-group">
            {{ education_form.field_of_study.label }}<br>
            {{ education_form.field_of_study(class="form-control") }}
          </div>
          <div class="row form-group">
            <div class="col-md">
            {{ education_form.start_date.label }}<br>
            {{ education_form.start_date(class="form-control") }}
          </div>
            <div class="col-md">
            {{ education_form.end_date.label }}<br>
            {{ education_form.end_date(class="form-control") }}
          </div>
            </div>
          <div class="form-group">
            {{ education_form.ongoing() }} {{ education_form.ongoing.label }}
          </div>

          <!-- Add other fields as needed -->
          <div class="d-grid gap-2 col-6 mx-auto">
          {{ education_form.submit(class="btn btn-primary") }}
          </div>

        </form>
      </div>
    </div>
  </div>
</div>

<!-- Experience Modal -->
<div class="modal fade" id="addExperienceModal" tabindex="-1" role="dialog" aria-labelledby="addExperienceModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addExperienceModalLabel">Add Experience</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST">
          {{ experience_form.hidden_tag() }}
          <div class="form-group">
            {{ experience_form.company_name.label }}<br>
            {{ experience_form.company_name(class="form-control") }}
          </div>
          <div class="form-group">
            {{ experience_form.position.label }}<br>
            {{ experience_form.position(class="form-control") }}
          </div>
          <div class="row form-group">
            <div class="col-md">
            {{ experience_form.start_date.label }}<br>
            {{ experience_form.start_date(class="form-control") }}
          </div>
            <div class="col-md">
            {{ experience_form.end_date.label }}<br>
            {{ experience_form.end_date(class="form-control") }}
          </div>
            </div>
          <div class="form-group">
            {{ experience_form.ongoing() }} Ongoing
          </div>

          <div class="form-group">
            {{ experience_form.responsibilities.label }}<br>
            {{ experience_form.responsibilities(class="form-control") }}
          </div>


          <!-- Add other fields as needed -->
          <div class="d-grid gap-2 col-6 mx-auto">
          {{ experience_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Internship Modal -->
<div class="modal fade" id="addInternshipModal" tabindex="-1" role="dialog" aria-labelledby="addInternshipModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addInternshipModalLabel">Add Internship</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST">
          {{ internship_form.hidden_tag() }}
          <div class="form-group">
            {{ internship_form.company_name.label }}<br>
            {{ internship_form.company_name(class="form-control") }}
          </div>
                    <div class="form-group">
            {{ internship_form.position.label }}<br>
            {{ internship_form.position(class="form-control") }}
          </div>
          <div class="row form-group">
            <div class="col-md">
            {{ internship_form.start_date.label }}<br>
            {{ internship_form.start_date(class="form-control") }}
          </div>
            <div class="col-md">
            {{ internship_form.end_date.label }}<br>
            {{ internship_form.end_date(class="form-control") }}
          </div>
            </div>
          <div class="form-group">
            {{ internship_form.ongoing() }} Ongoing
          </div>

          <div class="form-group">
            {{ internship_form.job_description.label }}<br>
            {{ internship_form.job_description(class="form-control") }}
          </div>


          <!-- Add other fields as needed -->
          <div class="d-grid gap-2 col-6 mx-auto">
          {{ internship_form.submit(class="btn btn-primary") }}
          </div>

        </form>
      </div>
    </div>
  </div>
</div>

<!-- Project Modal -->
<div class="modal fade" id="addProjectModal" tabindex="-1" role="dialog" aria-labelledby="addProjectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addProjectModalLabel">Add Project</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="{{url_for('jobseeker_add_project')}}">
          {{ project_form.hidden_tag() }}
          <div class="form-group">
            {{ project_form.title.label }}<br>
            {{ project_form.title(class="form-control") }}
          </div>
                    <div class="form-group">
            {{ project_form.description.label }}<br>
            {{ project_form.description(class="form-control") }}
          </div>
                    <div class="form-group">
            {{ project_form.project_url.label }}<br>
            {{ project_form.project_url(class="form-control") }}
          </div>

                    <div class="d-grid gap-2 col-6 mx-auto">
          {{ project_form.submit(class="btn btn-primary") }}
          </div>

        </form>
      </div>
    </div>
  </div>
</div>

<!-- Accomplishment Modal -->
<div class="modal fade" id="addAccomplishmentModal" tabindex="-1" role="dialog" aria-labelledby="addAccomplishmentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addAccomplishmentModalLabel">Add Accomplishment</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
<form method="POST" action="{{url_for('jobseeker_add_accomplishment')}}">
  {{ accomplishment_form.hidden_tag() }}
  <div class="form-group">
    {{ accomplishment_form.title.label }}<br>
    {{ accomplishment_form.title(class="form-control") }}
  </div>
  <div class="form-group">
    {{ accomplishment_form.description.label }}<br>
    {{ accomplishment_form.description(class="form-control") }}
  </div>
  <div class="form-group">
    {{ accomplishment_form.achievement_date.label }}<br>
    {{ accomplishment_form.achievement_date(class="form-control") }}
  </div>
  <div class="d-grid gap-2 col-6 mx-auto">
  {{ accomplishment_form.submit(class="btn btn-primary") }}
  </div>
</form>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="changeNameModal" tabindex="-1" aria-labelledby="changeNameModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="changeNameModalLabel">Change Name</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="{{ url_for('collect_jobseeker_name') }}" method="POST">
          {{ name_form.hidden_tag() }}
          <div class="d-flex">
          <div class="w-50 mb-3">
            {{ name_form.firstname.label }}
            {{ name_form.firstname(class="form-control") }}
          </div>
          <div class="w-50 mb-3">
            {{ name_form.lastname.label }}
            {{ name_form.lastname(class="form-control") }}
          </div>
          </div>

        <div class="d-grid gap-2 col-6 mx-auto">
        {{ name_form.submit(class="btn btn-primary") }}
        </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal for Email Change -->
<div class="modal fade" id="changeEmailModal" tabindex="-1" aria-labelledby="changeEmailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="changeEmailModalLabel">Change Email</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="{{ url_for('collect_jobseeker_email') }}" method="POST">
          {{ email_form.hidden_tag() }}
          <div class="mb-3">
            {{ email_form.email.label }}
            {{ email_form.email(class="form-control") }}
          </div>
          <div class="d-grid gap-2 col-6 mx-auto">
            {{ email_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal for Phone Number Change -->
<div class="modal fade" id="changePhoneModal" tabindex="-1" aria-labelledby="changePhoneModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="changePhoneModalLabel">Change Phone Number</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="{{ url_for('collect_jobseeker_phone') }}" method="POST">
          {{ phone_form.hidden_tag() }}
          <div class="mb-3">
            {{ phone_form.phone_number.label }}
            {{ phone_form.phone_number(class="form-control") }}
          </div>
          <div class="d-grid gap-2 col-6 mx-auto">
            {{ phone_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="changePictureModal" tabindex="-1" aria-labelledby="changePictureModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="changePictureModalLabel">Upload</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="{{ url_for('collect_jobseeker_profile_picture') }}" method="POST" enctype="multipart/form-data">
          {{ profile_picture_form.hidden_tag() }}
          <div class="mb-3">
            {{ profile_picture_form.profile_picture.label }}
            {{ profile_picture_form.profile_picture(class="form-control") }}
          </div>
          <div class="d-grid gap-2 col-6 mx-auto">
            {{ profile_picture_form.submit(class="btn btn-primary") }}
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap and jQuery scripts for modals -->


{% endblock %}


{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const fileList = document.getElementById('file-list');
    const uploadButton = document.getElementById('btn-upload');
    const errorMessage = document.getElementById('error-message');
    const uploadForm = document.getElementById('upload-form');
    let filesArray = [];

    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.classList.add('dragover');
    });

    dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('dragover');
    });

    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.classList.remove('dragover');
        const newFiles = Array.from(e.dataTransfer.files);
        addFiles(newFiles);
    });

    fileInput.addEventListener('change', () => {
        const newFiles = Array.from(fileInput.files);
        addFiles(newFiles);
        fileInput.value = "";
    });

    uploadForm.addEventListener('submit', (e) => {
        e.preventDefault();
        uploadFiles();
    });

    function addFiles(newFiles) {
        const allowedTypes = [
        'application/pdf', 'application/msword'];
        newFiles.forEach(file => {
            if (allowedTypes.includes(file.type)) {
                if (file.size <= 2 * 1024 * 1024) {
                    filesArray.push(file);
                    errorMessage.textContent = '';
                } else {
                    errorMessage.textContent = 'Some files were not added because they exceed the 2MB size limit.';
                }
            } else {
                errorMessage.textContent = 'Some files were not added because they are not of valid type.';
            }
        });
        updateFileList();
    }

    function updateFileList() {
        fileList.innerHTML = '';
        filesArray.forEach((file, index) => {
            const fileItem = document.createElement('p');
            fileItem.textContent = `${index + 1}. ${file.name}`;
            fileList.appendChild(fileItem);
        });
        uploadButton.style.display = filesArray.length > 0 ? 'inline-block' : 'none';
    }

    async function uploadFiles() {
        if (filesArray.length === 0) {
            alert('No files selected for upload.');
            return;
        }

        const formData = new FormData();
        filesArray.forEach((file) => {
            formData.append('files', file);
        });

        const loadingBarContainer = document.getElementById('loading-bar-container'); // Your loader span
        loadingBarContainer.style.display = 'inline-block'; // Change display to inline-block or block as needed


        try {
            const response = await fetch('/jobseeker/upload-resume', {
                method: 'POST',
                body: formData
            });

            loadingBarContainer.style.display = 'none';


            const contentType = response.headers.get('content-type');
            if (contentType && contentType.indexOf('application/json') !== -1) {
                const result = await response.json();
                if (response.status === 200) {
                    alert(result.message);
                    window.location.href = result.redirect; // Redirect to the given URL
                } else {
                    alert('Failed to upload media: ' + result.message);
                }
            } else {
                const text = await response.text();
                console.error('Error uploading files:', text);
                alert('Failed to upload media. Server responded with an error: ' + text);
            }
        } catch (error) {
            console.error('Error uploading files:', error);
            alert('Failed to upload media. An error occurred: ' + error.message);
        }
    }
});
</script>

{% endblock %}