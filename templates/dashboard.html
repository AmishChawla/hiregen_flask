{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}
{% set stage_colors = [
    'bg-blue-500',      
    'bg-yellow-500',    
    'bg-orange-500',    
    'bg-purple-500',    
    'bg-green-500',     
    'bg-emerald-600',   
    'bg-pink-500',      
    'bg-red-500',      
] %}
{% block content %}
{% if current_user.company == None %}



<!-- Alerts -->
<div class="bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-400 dark:border-yellow-700 p-4 my-4">
    <div class="flex">
        <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-yellow-400 dark:text-yellow-300" xmlns="http://www.w3.org/2000/svg" fill="none"
                viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M10.59 12.59a1.5 1.5 0 102.12-2.12M12 11.25V7.5m6.5 4.5l-.21-.21a1.5 1.5 0 10-2.12-2.12L16 10m0-5h4v4m-1.5-1.5l-.21-.21a1.5 1.5 0 10-2.12-2.12L16 3.5" />
            </svg>
        </div>
        <div class="ml-3">
            <p class="text-sm text-yellow-700 dark:text-yellow-300">
                Register your company to start posting jobs
                <a href="{{ url_for('company_register') }}"
                    class="font-medium text-yellow-700 dark:text-yellow-300 hover:underline">here</a>.
            </p>
        </div>
    </div>
</div>
{% endif %}

<div class="py-6 px-4 sm:px-6 lg:px-8">
    <div class="min-h-screen py-0">
        <div class="containerr mxauto px-4 sm:px-6 lg:px-0">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Dashboard</h1>
            <!-- Metric Cards -->
            <section class="grid md:grid-cols-2 xl:grid-cols-4 gap-6 my-6">
                <div
                    class="rounded-lg border bg-white text-card-foreground shadow-sm hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="p-3 bg-blue-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg"
                                        width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                        class="lucide lucide-users w-6 h-6 text-blue-600"
                                        data-lov-id="src/pages/Index.tsx:27:20" data-lov-name="Users"
                                        data-component-path="src/pages/Index.tsx" data-component-line="27"
                                        data-component-file="Index.tsx" data-component-name="Users"
                                        data-component-content="%7B%22className%22%3A%22w-6%20h-6%20text-blue-600%22%7D">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="9" cy="7" r="4"></circle>
                                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                    </svg></div>
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Total Candidates</p>
                                    <p class="text-2xl font-bold text-gray-900">{{ applicants_count }}</p>
                                </div>
                            </div>
                            <!-- <div class="flex items-center gap-1 text-green-600"><svg xmlns="http://www.w3.org/2000/svg"
                                    width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                    class="lucide lucide-trending-up w-4 h-4"
                                    data-lov-id="src/components/MetricsCard.tsx:31:14" data-lov-name="TrendingUp"
                                    data-component-path="src/components/MetricsCard.tsx" data-component-line="31"
                                    data-component-file="MetricsCard.tsx" data-component-name="TrendingUp"
                                    data-component-content="%7B%22className%22%3A%22w-4%20h-4%22%7D">
                                    <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                                    <polyline points="16 7 22 7 22 13"></polyline>
                                </svg><span class="text-sm font-medium">+12%</span></div> -->
                        </div>
                    </div>
                </div>


                <div
                    class="rounded-lg border bg-white text-card-foreground shadow-sm hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="p-3 bg-blue-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg"
                                        width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                        class="lucide lucide-briefcase w-6 h-6 text-green-600"
                                        data-lov-id="src/pages/Index.tsx:34:20" data-lov-name="Briefcase"
                                        data-component-path="src/pages/Index.tsx" data-component-line="34"
                                        data-component-file="Index.tsx" data-component-name="Briefcase"
                                        data-component-content="%7B%22className%22%3A%22w-6%20h-6%20text-green-600%22%7D">
                                        <path d="M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                                        <rect width="20" height="14" x="2" y="6" rx="2"></rect>
                                    </svg></div>
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Total Jobs</p>
                                    <p class="text-2xl font-bold text-gray-900">{{ total_jobs }}</p>
                                </div>
                            </div>
                            <!-- <div class="flex items-center gap-1 text-green-600"><svg xmlns="http://www.w3.org/2000/svg"
                                    width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                    class="lucide lucide-trending-up w-4 h-4"
                                    data-lov-id="src/components/MetricsCard.tsx:31:14" data-lov-name="TrendingUp"
                                    data-component-path="src/components/MetricsCard.tsx" data-component-line="31"
                                    data-component-file="MetricsCard.tsx" data-component-name="TrendingUp"
                                    data-component-content="%7B%22className%22%3A%22w-4%20h-4%22%7D">
                                    <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                                    <polyline points="16 7 22 7 22 13"></polyline>
                                </svg><span class="text-sm font-medium">+3</span></div> -->
                        </div>
                    </div>
                </div>

                <div
                    class="rounded-lg border bg-white text-card-foreground shadow-sm hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="p-3 bg-blue-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg"
                                        width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                        class="lucide lucide-clock w-6 h-6 text-purple-600"
                                        data-lov-id="src/pages/Index.tsx:41:20" data-lov-name="Clock"
                                        data-component-path="src/pages/Index.tsx" data-component-line="41"
                                        data-component-file="Index.tsx" data-component-name="Clock"
                                        data-component-content="%7B%22className%22%3A%22w-6%20h-6%20text-purple-600%22%7D">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12 6 12 12 16 14"></polyline>
                                    </svg></div>
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Interviews Scheduled</p>
                                    <p class="text-2xl font-bold text-gray-900">{{mid_stage_applicants_count}}</p>
                                </div>
                            </div>
                            <!-- <div class="flex items-center gap-1 text-green-600"><svg xmlns="http://www.w3.org/2000/svg"
                                    width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                    class="lucide lucide-trending-up w-4 h-4"
                                    data-lov-id="src/components/MetricsCard.tsx:31:14" data-lov-name="TrendingUp"
                                    data-component-path="src/components/MetricsCard.tsx" data-component-line="31"
                                    data-component-file="MetricsCard.tsx" data-component-name="TrendingUp"
                                    data-component-content="%7B%22className%22%3A%22w-4%20h-4%22%7D">
                                    <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                                    <polyline points="16 7 22 7 22 13"></polyline>
                                </svg><span class="text-sm font-medium">+8%</span></div> -->
                        </div>
                    </div>
                </div>

                <div
                    class="rounded-lg border bg-white text-card-foreground shadow-sm hover:shadow-lg transition-shadow duration-200">
                    <div class="p-6">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <div class="p-3 bg-blue-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg"
                                        width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                        class="lucide lucide-trending-up w-6 h-6 text-orange-600"
                                        data-lov-id="src/pages/Index.tsx:48:20" data-lov-name="TrendingUp"
                                        data-component-path="src/pages/Index.tsx" data-component-line="48"
                                        data-component-file="Index.tsx" data-component-name="TrendingUp"
                                        data-component-content="%7B%22className%22%3A%22w-6%20h-6%20text-orange-600%22%7D">
                                        <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                                        <polyline points="16 7 22 7 22 13"></polyline>
                                    </svg></div>
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Hire Rate</p>
                                    <p class="text-2xl font-bold text-gray-900">{{hiring_rate}}%</p>
                                </div>
                            </div>
                            <!-- <div class="flex items-center gap-1 text-green-600"><svg xmlns="http://www.w3.org/2000/svg"
                                    width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                    class="lucide lucide-trending-up w-4 h-4"
                                    data-lov-id="src/components/MetricsCard.tsx:31:14" data-lov-name="TrendingUp"
                                    data-component-path="src/components/MetricsCard.tsx" data-component-line="31"
                                    data-component-file="MetricsCard.tsx" data-component-name="TrendingUp"
                                    data-component-content="%7B%22className%22%3A%22w-4%20h-4%22%7D">
                                    <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                                    <polyline points="16 7 22 7 22 13"></polyline>
                                </svg><span class="text-sm font-medium">+2%</span></div> -->
                        </div>
                    </div>
                </div>
            </section>



            <!-- Charts Section -->
            <div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 mb-6">
                <div class="rounded-lg border bg-white text-card-foreground shadow-sm">
                    <div class="space-y-1.5 p-6 flex flex-row items-center justify-between">
                        <h3 class="text-2xl font-semibold leading-none tracking-tight">Job Status</h3>
                    </div>
                    <div class="h-80">
                    <canvas id="jobsChart"></canvas>
                    </div>
                    
                </div>

                {% set total_applicants = statuses | sum(attribute='applicant_count') %}
                <div class="rounded-lg border bg-white text-card-foreground shadow-sm">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="text-2xl font-semibold leading-none tracking-tight">Candidate Pipeline</h3>
                    </div>
                    <div class="p-6 pt-0">
                        <div class="space-y-4">
                            {% for stage in statuses | sort(attribute='stage_order') %}
                            {% set percent = (stage.applicant_count / total_applicants * 100) if total_applicants else 0 %}
                            {% set color = stage_colors[loop.index0 % stage_colors|length] %}
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium text-gray-700">{{ stage.name }}</span>
                                    <span class="text-sm font-semibold text-gray-900">{{ stage.applicant_count }}</span>
                                </div>
                                <div class="relative">
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="h-2 rounded-full {{ color }} transition-all duration-300"
                                             style="width: {{ percent|round(2) }}%;"></div>
                                    </div>
                                    <span class="absolute right-0 top-3 text-xs text-gray-500">{{ percent|int }}%</span>
                                </div>
                            </div>
                        {% endfor %}                        </div>
                    </div>
                </div>

                <!-- <div
                    class="p-5 dark:border-gray-800 dark:bg-white/[0.03] rounded-lg border text-card-foreground shadow-sm bg-white/60 backdrop-blur-sm border-slate-200/60 animate-fade-in h-64">
                    <h3 class="tracking-tight text-lg font-medium">Hiring Pipeline</h3>
                    <canvas id="applicantsChart" class="mt-6"></canvas>
                </div> -->
            </div>


            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold leading-none tracking-tight">Recent Job Postings</h3><a href="user/job-openings"
                            class="text-blue-600 hover:text-blue-700 text-sm font-medium">View All</a>
                    </div>
                    {% if latest_jobs %}
                    <div class="space-y-4">
                        {% for data in latest_jobs %}
                        {% if data.status == 'published' %}
                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">{{ data.job_title }}</h4>
                                    <p class="text-sm text-gray-600 mt-1">{{data.job_type}} • {{
                                            data.created_at.split('T')[0] }}</p>
                                    <div class="flex items-center mt-3 space-x-4"><span class="text-sm text-gray-600"><a
                                                class="text-blue-600"
                                                href="{{ url_for('job_applicants', job_id=data.id) }}">{{
                                                data.applicant_count }} applications</a></span>
                                    </div>
                                </div><span
                                    class="px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">{{ data.job_opening_status }}</span>
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                <!-- Top AI-Matched Candidates -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-2xl font-semibold leading-none tracking-tight">Upcoming Interviews/Assessments</h3><button
                            class="text-blue-600 hover:text-blue-700 text-sm font-medium">View All</button>
                    </div>
                    <div class="space-y-4">
                        {% for applicant in mid_stage_applicants %}
                        <a href="{{url_for('employer_view_jobseeker_profile', jobseeker_id=applicant.jobseeker.id)}}">
                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start space-x-3">
                                    <div
                                        class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                        <img src="{{applicant.jobseeker.profile_picture}}" alt="Profile Picture" class="w-10 h-10 rounded-full">
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-gray-900">{{applicant.jobseeker.firstname}} {{applicant.jobseeker.lastname}}</h4>
                                        <p class="text-xs text-gray-600">{{applicant.jobseeker.email}}</p>
                                        <p class="text-xs text-gray-600 italic"><a href="{{url_for('get_post_by_company_subdomain_and_slug', company_subdomain=applicant.job.company_subdomain, job_slug=applicant.job.slug)}}">Applying for the job of <span class="font-medium text-blue-600 hover:text-blue-700">{{applicant.job.title}}</span></a></p>
                                        <div class="flex flex-wrap gap-1 mt-2">
                                            {% if applicant.event_date %}
                                            <span class="px-2 py-1 text-xs border border-blue-700 rounded-full inline-flex items-center gap-x-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                                                    <path d="M5.75 7.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM5 10.25a.75.75 0 1 1 1.5 0 .75.75 0 0 1-1.5 0ZM10.25 7.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM7.25 8.25a.75.75 0 1 1 1.5 0 .75.75 0 0 1-1.5 0ZM8 9.5A.75.75 0 1 0 8 11a.75.75 0 0 0 0-1.5Z" />
                                                    <path fill-rule="evenodd" d="M4.75 1a.75.75 0 0 0-.75.75V3a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2V1.75a.75.75 0 0 0-1.5 0V3h-5V1.75A.75.75 0 0 0 4.75 1ZM3.5 7a1 1 0 0 1 1-1h7a1 1 0 0 1 1 1v4.5a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V7Z" clip-rule="evenodd" />
                                                  </svg>                                              
                                                  {{applicant.event_date}}</span>
                                            {% endif %}
                                            {% if applicant.event_time %}
                                            <span class="px-2 py-1 text-xs border border-blue-700 rounded-full inline-flex items-center gap-x-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                                                    <path fill-rule="evenodd" d="M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8Zm7.75-4.25a.75.75 0 0 0-1.5 0V8c0 .414.336.75.75.75h3.25a.75.75 0 0 0 0-1.5h-2.5v-3.5Z" clip-rule="evenodd" />
                                                  </svg>
                                                  {{applicant.event_time}}</span>
                                            {% endif %}
                                            {% if applicant.stage_log.event_link %}
                                            <span class="px-2 py-1 text-xs border border-blue-700 rounded-full inline-flex items-center gap-x-1">
                                                <a href="{{applicant.stage_log.event_link}}" class="inline-flex items-center gap-x-1">
                                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                                                    <path fill-rule="evenodd" d="M8.914 6.025a.75.75 0 0 1 1.06 0 3.5 3.5 0 0 1 0 4.95l-2 2a3.5 3.5 0 0 1-5.396-4.402.75.75 0 0 1 1.251.827 2 2 0 0 0 3.085 2.514l2-2a2 2 0 0 0 0-2.828.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                                                    <path fill-rule="evenodd" d="M7.086 9.975a.75.75 0 0 1-1.06 0 3.5 3.5 0 0 1 0-4.95l2-2a3.5 3.5 0 0 1 5.396 4.402.75.75 0 0 1-1.251-.827 2 2 0 0 0-3.085-2.514l-2 2a2 2 0 0 0 0 2.828.75.75 0 0 1 0 1.06Z" clip-rule="evenodd" />
                                                  </svg>{{applicant.stage_log.event_link}}
                                                </a></span>
                                                {% endif %}
                                                {% if applicant.stage_log.place %}
                                                <span class="px-2 py-1 text-xs border border-blue-700 rounded-full inline-flex items-center gap-x-1">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                                                        <path fill-rule="evenodd" d="m7.539 14.841.003.003.002.002a.755.755 0 0 0 .912 0l.002-.002.003-.003.012-.009a5.57 5.57 0 0 0 .19-.153 15.588 15.588 0 0 0 2.046-2.082c1.101-1.362 2.291-3.342 2.291-5.597A5 5 0 0 0 3 7c0 2.255 1.19 4.235 2.292 5.597a15.591 15.591 0 0 0 2.046 2.082 8.916 8.916 0 0 0 .189.153l.012.01ZM8 8.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" clip-rule="evenodd" />
                                                      </svg>
                                                                                                            {{applicant.stage_log.place}}</span>
                                                {% endif %}
                                            <span class="px-2 py-1 text-xs border border-blue-700 rounded-full inline-flex items-center gap-x-1">
                                                <a href="{{url_for('job_applicants', job_id=applicant.application.job_opening_id)}}" class="inline-flex items-center gap-x-1">
                                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                                                    <path d="M8.5 4.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0ZM10.9 12.006c.11.542-.348.994-.9.994H2c-.553 0-1.01-.452-.902-.994a5.002 5.002 0 0 1 9.803 0ZM14.002 12h-1.59a2.556 2.556 0 0 0-.04-.29 6.476 6.476 0 0 0-1.167-2.603 3.002 3.002 0 0 1 3.633 1.911c.18.522-.283.982-.836.982ZM12 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                                                  </svg>
                                                  
                                                  Other Applicants</a></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right self-start flex-shrink-0">
                                    <span class="px-2 py-1 rounded-full text-xs font-medium mt-2 inline-block bg-blue-100 text-blue-800">
                                        {{applicant.stage_log.stage_name}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const jobsCtx = document.getElementById('jobsChart').getContext('2d');
    new Chart(jobsCtx, {
        type: 'bar',
        data: {
            labels: ['Total Jobs', 'Active Jobs', 'Applicants'],
            datasets: [{
                data: [{{ total_jobs }}, {{ in_progress_jobs }}, {{ applicants_count }}],
        backgroundColor: ['#60A5FA', '#34D399', '#FCD34D'], // Softer colors: Blue, Green, Yellow
        borderRadius: 6, // Slightly rounded bar edges
        barPercentage: 0.5, // Reduce bar width (50% of the category width)
        categoryPercentage: 0.8, // Increase spacing between bars
        }]
    },
        options: {
        plugins: {
            legend: {
                display: false, // No legend needed
            },
            tooltip: {
                backgroundColor: '#1F2937', // Dark background for tooltips
                titleColor: '#FFFFFF',
                bodyColor: '#FFFFFF',
            },
        },
        scales: {
            x: {
                grid: {
                    display: false, // Remove horizontal grid lines
                },
                ticks: {
                    color: '#6B7280', // Tailwind gray-500 for text
                },
            },
            y: {
                grid: {
                    display: false, // Light gray grid lines
                },
                ticks: {
                    color: '#6B7280', // Tailwind gray-500 for text
                    stepSize: 1, // Increment by 1
                    beginAtZero: true,
                    max: Math.ceil(Math.max({{ total_jobs }}, {{ in_progress_jobs }}, {{ applicants_count }})) + 1, // Dynamically set max value
                },
            },
        },
    layout: {
        padding: 16, // Space around the chart
        },
    responsive: true,
        maintainAspectRatio: false, // Ensures charts fit within cards
    },
});

    const applicantsCtx = document.getElementById('applicantsChart').getContext('2d');
    new Chart(applicantsCtx, {
        type: 'bar',
        data: {
            labels: [{% for status in statuses %}'{{ status.name }}',{% endfor %}],
        datasets: [{
            data: [{% for status in statuses %}{{ status.applicant_count }}, {% endfor %}],
        backgroundColor: ['#60A5FA', '#34D399', '#FCD34D', '#FB923C', '#F87171', '#A78BFA'], // Updated colors
        borderRadius: 6, // Slightly rounded bar edges
        barPercentage: 0.5, // Reduce bar width
        categoryPercentage: 0.8, // Increase spacing between bars
        }]
    },
        options: {
        plugins: {
            legend: {
                display: false, // No legend needed
            },
            tooltip: {
                backgroundColor: '#1F2937', // Dark background for tooltips
                titleColor: '#FFFFFF',
                bodyColor: '#FFFFFF',
            },
        },
        scales: {
            x: {
                grid: {
                    display: false, // Remove horizontal grid lines
                },
                ticks: {
                    color: '#6B7280', // Tailwind gray-500 for text
                },
            },
            y: {
                grid: {
                    display: false, // Light gray grid lines
                },
                ticks: {
                    color: '#6B7280', // Tailwind gray-500 for text
                    stepSize: 1, // Increment by 1
                    beginAtZero: true,
                    max: Math.ceil(Math.max({% for status in statuses %}{{ status.applicant_count }}, {% endfor %})) + 1, // Dynamically set max value
                },
            },
        },
    layout: {
        padding: 16, // Space around the chart
        },
    responsive: true,
        maintainAspectRatio: false, // Ensures charts fit within cards
    },
});

</script>
{% endblock %}