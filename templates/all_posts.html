{% extends 'common_base.html' %}

{% block title %}From the Blog{% endblock %}

{% block content %}
    <div class="bg-white py-12 sm:py-16">
        <div class="mx-auto max-w-7xl px-6 lg:px-8">
            <div class="mx-auto max-w-2xl text-center">
                <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">From the Blog</h1>
                <p class="mt-4 text-lg leading-8 text-gray-600">Learn how to grow your business with our expert advice.</p>
            </div>
            
            <div class="mx-auto mt-16 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-12 lg:mx-0 lg:max-w-none lg:grid-cols-3">
                {% for post in result %}
                <article class="flex flex-col items-start group">
                    <div class="relative w-full">
                        <img src="{{ post.featured_image or url_for('static', filename='images/blog-bg.jpg') }}"
                             alt="{{ post.title }}"
                             class="aspect-[16/9] w-full rounded-2xl bg-gray-50 object-cover sm:aspect-[2/1] lg:aspect-[3/2]">
                        <div class="absolute inset-0 rounded-2xl ring-1 ring-inset ring-gray-900/10"></div>
                    </div>
                    
                    <div class="max-w-xl mt-6">
                        <div class="flex items-center gap-x-4 text-xs">
                            <time datetime="{{ post.created_at }}" class="text-gray-500">
                                {{ post.created_at }}
                            </time>
                            <a href="{{url_for('cms_posts_by_category', category=post.category_name)}}" 
                               class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-50">
                                {{ post.category_name }}
                            </a>
                        </div>
                        
                        <div class="group relative">
                            <h3 class="mt-3 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600">
                                <a href="{{url_for('read_post', slug=post.slug)}}">
                                    <span class="absolute inset-0"></span>
                                    {{ post.title }}
                                </a>
                            </h3>
                            <p class="mt-5 line-clamp-3 text-sm leading-6 text-gray-600">
                                {{ post.short_description or (post.content[:200] + '...') | safe }}
                            </p>
                        </div>
                        
                        <div class="mt-4 flex flex-wrap gap-2">
                            {% for tag in post.tags %}
                            <a href="{{url_for('cms_posts_by_tag', tag=tag)}}" 
                               class="text-xs text-blue-600 hover:text-blue-800">
                                #{{ tag }}
                            </a>
                            {% endfor %}
                        </div>
                        
                        <div class="relative mt-8 flex items-center gap-x-4">
                            <img src="{{ post.profile_picture or url_for('static', filename='images/empty_avatar.png') }}" 
                                 alt="{{ post.username }}" 
                                 class="h-10 w-10 rounded-full bg-gray-50">
                            <div class="text-sm leading-6">
                                <p class="font-semibold text-gray-900">
                                    <span class="absolute inset-0"></span>
                                    {{ post.username }}
                                </p>
                            </div>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}
